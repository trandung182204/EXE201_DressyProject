<!DOCTYPE html>
<html class="no-js" lang="zxx">

<!-- Mirrored from nta0309-ecommerce-admin-dashboard.netlify.app/customer-list by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 10 Jan 2026 02:38:09 GMT -->
<!-- Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->

<head>
	<!-- Meta Tags -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="keywords" content="Site keywords here">
	<meta name="description" content="#">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Site Title -->
	<title>Sherah - HTML eCommerce Dashboard Template</title>

	<!-- Font -->
	<link
		href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900&amp;display=swap"
		rel="stylesheet">

	<!-- Fav Icon -->
	<link rel="icon" href="img/favicon.png">

	<!-- sherah Stylesheet -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/font-awesome-all.min.css">
	<link rel="stylesheet" href="css/charts.min.css">
	<link rel="stylesheet" href="css/datatables.min.css">
	<link rel="stylesheet" href="css/jvector-map.css">
	<link rel="stylesheet" href="css/slickslider.min.css">
	<link rel="stylesheet" href="css/jquery-ui.css">
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="style.css">

</head>

<body id="sherah-dark-light">

	<div class="sherah-body-area">
		<!-- sherah Admin Menu -->
		<div id="header-container"></div>
		<!-- End sherah Admin Menu -->
		<div id="dashboard-container"></div>
		<!-- End Header -->

		<!-- sherah Dashboard -->
		<section class="sherah-adashboard sherah-show">
			<div class="container">
				<div class="row">
					<div class="col-12">
						<div class="sherah-body">
							<!-- Dashboard Inner -->
							<div class="sherah-dsinner">
								<div class="row">
									<div class="col-12">
										<div class="sherah-breadcrumb mg-top-30">
											<h2 class="sherah-breadcrumb__title">Pages</h2>
											<ul class="sherah-breadcrumb__list">
												<li><a href="#">Home</a></li>
												<li class="active"><a href='product-list.html'>Product List</a></li>
											</ul>
										</div>
									</div>
								</div>
								<div class="sherah-table sherah-page-inner sherah-border sherah-default-bg mg-top-25">
									<!-- Filter, Search, and Page Controls -->
									<div style="display: flex; gap: 16px; align-items: center; margin-bottom: 12px;">
										<div>
											<input id="filter-product-name" type="text"
												placeholder="Filter by product name..."
												style="padding: 4px 8px; border-radius: 4px; border: 1px solid #ccc;">
										</div>
										<div>
											<input id="filter-provider-name" type="text"
												placeholder="Filter by provider name..."
												style="padding: 4px 8px; border-radius: 4px; border: 1px solid #ccc;">
										</div>
									</div>
									<table id="sherah-table__vendor" class="sherah-table__main sherah-table__main-v3">
										<!-- sherah Table Head -->
										<thead class="sherah-table__head">
											<tr>
												<th class="sherah-table__column-2 sherah-table__h2">Image</th>
												<th class="sherah-table__column-3 sherah-table__h2 sortable"
													data-sort="fullName">Product Name <span
														class="sort-indicator"></span></th>
												<th class="sherah-table__column-3 sherah-table__h3 sortable"
													data-sort="email">Provider Name <span class="sort-indicator"></span>
												</th>
												<th class="sherah-table__column-5 sherah-table__h5 sortable"
													data-sort="phone">Product Type <span class="sort-indicator"></span>
												</th>
												<th class="sherah-table__column-7 sherah-table__h6 sortable"
													data-sort="status">Status <span class="sort-indicator"></span></th>
												<th class="sherah-table__column-8 sherah-table__h7 sortable"
													data-sort="createdAt">Create At <span class="sort-indicator"></span>
												</th>
											</tr>
										</thead>
										<tbody class="sherah-table__body" id="product-table-body">
											<!-- User rows will be injected here by JS -->
										</tbody>
									</table>
									<!-- Pagination Controls -->
									<div id="product-pagination"
										style="display: flex; justify-content: flex-end; align-items: center; margin-top: 12px;">
									</div>
								</div>
							</div>
							<!-- End Dashboard Inner -->
						</div>
					</div>


				</div>
			</div>
		</section>
		<!-- End sherah Dashboard -->

	</div>

	<!-- sherah Scripts -->
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-migrate.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/charts.js"></script>
	<script src="js/datatables.min.js"></script>
	<script src="js/circle-progress.min.js"></script>
	<script src="js/jquery-jvectormap.js"></script>
	<script src="js/jvector-map.js"></script>
	<script src="js/slickslider.min.js"></script>
	<script src="js/main.js"></script>
	<script src="js/auth-header.js"></script>
	
	<script>
		const API_BASE =
			location.hostname === "localhost" || location.hostname === "127.0.0.1"
				? "http://localhost:5135/api"
				: "/api";


		const productApiBase = `${API_BASE}/Products`;
		const providerApiBase = `${API_BASE}/Providers`;
		const productImagesApiBase = `${API_BASE}/ProductImages`;


		let allProducts = [];
		let allProviders = [];
		let allProductImages = [];

		let currentProductPage = 1;
		const productPageSize = 6;
		let currentProductSort = { field: '', dir: '' };

		/* ================= UPDATE PRODUCT STATUS ================= */
		function updateProductStatus(productId, status) {
			fetch(`${productApiBase}/${productId}/status`, {
				method: 'PUT',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify({ status: status })
			})
				.then(res => res.json())
				.then(res => {
					if (!res.success) {
						alert('Failed to update status: ' + (res.message || 'Unknown error'));
					} else {
						fetchProducts();
					}
				})
				.catch(err => alert('Failed to update status: ' + err));
		}

		/* ================= RENDER PRODUCTS ================= */
		function renderProducts(products) {
			const tbody = document.getElementById('product-table-body');
			if (!tbody) return;

			tbody.innerHTML = '';

			products.forEach(product => {
				let imgHtml = '';
				let imgUrl = '';

				if (product.productImages && Array.isArray(product.productImages) && product.productImages.length > 0) {
					imgUrl = product.productImages[0].imageUrl || product.productImages[0].ImageUrl;
				} else {
					const foundImg = allProductImages.find(img => img.productId === product.id);
					if (foundImg) imgUrl = foundImg.imageUrl || foundImg.ImageUrl;
				}

				if (imgUrl) {
					imgHtml = `<img src="${imgUrl}" alt="${product.name}" style="width:128px;height:128px;object-fit:cover;border-radius:8px;">`;
				}

				let providerName = '';
				if (product.provider && (product.provider.brandName || product.provider.BrandName)) {
					providerName = product.provider.brandName || product.provider.BrandName;
				} else if (product.providerId) {
					const foundProvider = allProviders.find(p => p.id === product.providerId);
					if (foundProvider) providerName = foundProvider.brandName || foundProvider.BrandName || '';
				}

				const statusVal = (product.status || product.Status || '').toUpperCase();
				let statusClass = '';
				if (statusVal === 'AVAILABLE') statusClass = 'status-available';
				else if (statusVal === 'UNAVAILABLE') statusClass = 'status-unavailable';

				const tr = document.createElement('tr');
				tr.innerHTML = `
				<td>${imgHtml}</td>
				<td>${product.name || ''}</td>
				<td>${providerName}</td>
				<td>${product.productType || product.ProductType || ''}</td>
				<td>
					<select class="status-select ${statusClass}"
						onchange="updateProductStatus(${product.id}, this.value)">
						<option value="AVAILABLE" ${statusVal === 'AVAILABLE' ? 'selected' : ''}>Available</option>
						<option value="UNAVAILABLE" ${statusVal === 'UNAVAILABLE' ? 'selected' : ''}>Unavailable</option>
					</select>
				</td>
				<td>
					${product.createdAt
						? new Date(product.createdAt).toLocaleDateString()
						: (product.CreatedAt ? new Date(product.CreatedAt).toLocaleDateString() : '')}
				</td>
			`;
				tbody.appendChild(tr);
			});
		}

		/* ================= PAGINATION ================= */
		function renderProductPagination(total, page, pageSize) {
			const pageCount = Math.ceil(total / pageSize);
			const pagination = document.getElementById('product-pagination');
			if (!pagination) return;

			pagination.innerHTML = '';
			if (pageCount <= 1) return;

			let html = '';
			html += `<button ${page === 1 ? 'disabled' : ''} onclick="gotoProductPage(${page - 1})">&lt;</button>`;
			for (let i = 1; i <= pageCount; i++) {
				html += `<button ${i === page ? 'style="font-weight:bold; background:#eee;"' : ''} onclick="gotoProductPage(${i})">${i}</button>`;
			}
			html += `<button ${page === pageCount ? 'disabled' : ''} onclick="gotoProductPage(${page + 1})">&gt;</button>`;
			pagination.innerHTML = html;
		}

		function gotoProductPage(page) {
			currentProductPage = page;
			renderProductTable();
		}

		/* ================= SORT ================= */
		function sortProductBy(field) {
			if (currentProductSort.field === field) {
				currentProductSort.dir = currentProductSort.dir === 'asc' ? 'desc' : 'asc';
			} else {
				currentProductSort.field = field;
				currentProductSort.dir = 'asc';
			}
			renderProductTable();
			updateProductSortIndicators();
		}

		function updateProductSortIndicators() {
			document.querySelectorAll('th.product-sortable').forEach(th => {
				const span = th.querySelector('.sort-indicator');
				if (!span) return;
				if (th.dataset.sort === currentProductSort.field) {
					span.textContent = currentProductSort.dir === 'asc' ? '▲' : '▼';
				} else {
					span.textContent = '';
				}
			});
		}

		/* ================= TABLE ================= */
		function renderProductTable() {
			let products = allProducts.slice();

			const filterProductName = document.getElementById('filter-product-name')?.value.trim().toLowerCase();
			if (filterProductName) {
				products = products.filter(p => (p.name || '').toLowerCase().includes(filterProductName));
			}

			const filterProviderName = document.getElementById('filter-provider-name')?.value.trim().toLowerCase();
			if (filterProviderName) {
				products = products.filter(p => {
					let providerName = '';
					if (p.provider && (p.provider.brandName || p.provider.BrandName)) {
						providerName = p.provider.brandName || p.provider.BrandName;
					} else if (p.providerId) {
						const foundProvider = allProviders.find(pr => pr.id === p.providerId);
						if (foundProvider) providerName = foundProvider.brandName || foundProvider.BrandName || '';
					}
					return providerName.toLowerCase().includes(filterProviderName);
				});
			}

			if (currentProductSort.field) {
				products.sort((a, b) => {
					let va = a[currentProductSort.field] || '';
					let vb = b[currentProductSort.field] || '';
					if (currentProductSort.field === 'createdAt') {
						va = va ? new Date(va) : 0;
						vb = vb ? new Date(vb) : 0;
					}
					if (typeof va === 'string') va = va.toLowerCase();
					if (typeof vb === 'string') vb = vb.toLowerCase();
					if (va < vb) return currentProductSort.dir === 'asc' ? -1 : 1;
					if (va > vb) return currentProductSort.dir === 'asc' ? 1 : -1;
					return 0;
				});
			}

			const total = products.length;
			const start = (currentProductPage - 1) * productPageSize;
			const paged = products.slice(start, start + productPageSize);

			renderProducts(paged);
			renderProductPagination(total, currentProductPage, productPageSize);
		}

		/* ================= FETCH ================= */
		function fetchProducts() {
			Promise.all([
				fetch(productApiBase).then(res => res.json()),
				fetch(providerApiBase).then(res => res.json()),
				fetch(productImagesApiBase).then(res => res.json())
			]).then(([productsRes, providersRes, imagesRes]) => {
				if (productsRes.success) allProducts = productsRes.data || [];
				if (providersRes.success) allProviders = providersRes.data || [];
				if (imagesRes.success) allProductImages = imagesRes.data || [];

				currentProductPage = 1;
				renderProductTable();
			}).catch(err => {
				console.error('Failed to fetch products/providers/images:', err);
			});
		}

		document.addEventListener('DOMContentLoaded', function () {
			fetchProducts();

			document.getElementById('filter-product-name')?.addEventListener('input', () => {
				currentProductPage = 1;
				renderProductTable();
			});

			document.getElementById('filter-provider-name')?.addEventListener('input', () => {
				currentProductPage = 1;
				renderProductTable();
			});

			document.querySelectorAll('th.product-sortable').forEach(th => {
				th.style.cursor = 'pointer';
				th.addEventListener('click', () => sortProductBy(th.dataset.sort));
			});
		});
	</script>

	<script>
		async function loadLayout() {
			const headerRes = await fetch("header.html");
			document.getElementById("header-container").innerHTML = await headerRes.text();

			const dashRes = await fetch("dashboard.html");
			document.getElementById("dashboard-container").innerHTML = await dashRes.text();

			initSherahLayout();

			// ✅ quan trọng: gọi sau khi header đã có trong DOM
			if (window.loadAuthToHeader) window.loadAuthToHeader();
		}
	</script>

	<script>
		document.addEventListener("DOMContentLoaded", () => {
			loadLayout();
		});
	</script>

	<style>
		/* --- CSS cho Role (Quyền hạn) --- */
		.role-badge {
			display: inline-block;
			padding: 5px 10px;
			border-radius: 15px;
			font-size: 12px;
			font-weight: 600;
			text-transform: capitalize;
			margin-right: 5px;
			margin-bottom: 5px;
		}

		/* Màu sắc riêng cho từng Role */
		.role-admin {
			background-color: #ffebee;
			/* Nền đỏ nhạt */
			color: #c62828;
			/* Chữ đỏ đậm */
			border: 1px solid #ffcdd2;
		}

		.role-provider {
			background-color: #e3f2fd;
			/* Nền xanh dương nhạt */
			color: #1565c0;
			/* Chữ xanh dương đậm */
			border: 1px solid #bbdefb;
		}

		.role-customer {
			background-color: #e8f5e9;
			/* Nền xanh lá nhạt */
			color: #2e7d32;
			/* Chữ xanh lá đậm */
			border: 1px solid #c8e6c9;
		}

		/* Fallback cho role lạ */
		.role-default {
			background-color: #f5f5f5;
			color: #616161;
			border: 1px solid #e0e0e0;
		}

		/* --- CSS cho Status Select (Trạng thái) --- */
		.status-select {
			padding: 8px 18px;
			border-radius: 8px;
			font-weight: 600;
			font-size: 15px;
			cursor: pointer;
			outline: none;
			border: 1.5px solid #bdbdbd;
			transition: all 0.3s ease;
			appearance: none;
			-webkit-appearance: none;
			text-align: center;
			background: #f7f7f7;
			color: #333;
			box-shadow: 0 1px 4px rgba(0, 0, 0, 0.07);
			min-width: 120px;
		}

		.status-select.status-available {
			background-color: #e8f5e9;
			color: #1b5e20;
			border-color: #43a047;
		}

		.status-select.status-unavailable {
			background-color: #e8f5e9;
			color: #ed1a48;
			border-color: #ed1a48;
		}

		.status-select:hover {
			opacity: 0.97;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.13);
		}
	</style>



</body>

<!-- Mirrored from nta0309-ecommerce-admin-dashboard.netlify.app/customer-list by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 10 Jan 2026 02:38:10 GMT -->

</html>